import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,e as m,d as o,w as l,r as c,o as g,a as s,b as t}from"./app-D8u_YAsX.js";const h="/xbZhong/myMajor/note/image-20251227145217619.png",u="/xbZhong/myMajor/note/image-20251227150106399.png",d="/xbZhong/myMajor/note/image-20251227152057974.png",x="/xbZhong/myMajor/note/image-20251227111953048.png",y="/xbZhong/myMajor/note/image-20251225155039424.png",b="/xbZhong/myMajor/note/image-20251227135918615.png",A="/xbZhong/myMajor/note/image-20251231155824137.png",v={};function C(f,a){const i=c("Tabs");return g(),r("div",null,[a[24]||(a[24]=m('<p><a href="/pdfs/resource/coursenote/junior/embedding_system.pdf" target="_blank" rel="noopener noreferrer">本页PDF</a></p><h2 id="嵌入式系统概论" tabindex="-1"><a class="header-anchor" href="#嵌入式系统概论"><span>嵌入式系统概论</span></a></h2><p><strong>嵌入式系统</strong></p><ul><li>嵌入式系统是一切非PC和大型机的计算机系统</li><li>嵌入式系统以<strong>高性能、智能化</strong>发展方向为主，且得益于<strong>微电子技术、通信技术、感知测量技术</strong>的发展</li><li>以<strong>应用</strong>为中心</li><li>具有<strong>实时性、可靠性、功耗约束</strong></li></ul><p>设计目标：从<strong>高性能</strong>转向<strong>用户需求和资源约束的平衡</strong></p><p>MCU：微控制器单元，也叫做单片机，将内存、计数器等集成在一块芯片上，芯片级计算机</p><p>FPGA：现场可编辑门阵列，<strong>半定制电路</strong>，由逻辑功能块、输入输出块、布线资源组成</p><p>SoC：片上系统，系统级芯片</p><p><strong>计算的概念</strong>：数值计算、通用信息处理、智能计算</p><p><strong>ARM应用的两种开发方式</strong></p><ul><li>直接在ARM芯片上进行应用开发</li><li>在ARM上运行操作系统</li></ul><h3 id="计算机架构" tabindex="-1"><a class="header-anchor" href="#计算机架构"><span>计算机架构</span></a></h3><p><strong>冯-诺伊曼架构</strong></p><p>完整的计算机系统应该包含这五部分：存储器、运算器、控制器、输入设备、输出设备</p><ul><li>且由于<strong>运算器</strong>的数据吞吐能力有限，成为系统的瓶颈</li><li>后续以<strong>存储器</strong>为中心改进架构</li><li>内存储器放置正在运行的代码或数据，外存储器存放断电期的数据</li></ul><p><strong>哈佛架构</strong></p><p>对<strong>指令存储器和数据存储器</strong>进行了区分，分别设置**指令总线（I-Code）和数据总线（D-Code）**进行存取</p><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="指令集体系结构" tabindex="-1"><a class="header-anchor" href="#指令集体系结构"><span>指令集体系结构</span></a></h3><p>简称为ISA</p><ul><li>定义了一台计算机可以执行的所有指令的集合</li><li>定义处理器上的软件如何构建</li><li>复杂指令集：CISC，包含x86指令集</li><li>精简指令集：RISC，包括ARM指令集</li></ul><figure><img src="'+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="计算机体系结构" tabindex="-1"><a class="header-anchor" href="#计算机体系结构"><span>计算机体系结构</span></a></h3><p>指的是<strong>计算机的逻辑结构与功能特性</strong></p><h3 id="arm的体系结构" tabindex="-1"><a class="header-anchor" href="#arm的体系结构"><span>ARM的体系结构</span></a></h3><ul><li>主要包括微处理器所支持的<strong>指令集</strong>和基于该体系结构下微处理器的<strong>编程模型</strong></li><li>对于开发人员来说，体系结构最重要的部分是指此<strong>微处理器提供的指令系统和寄存器组</strong></li></ul><h2 id="cortex-m3微处理器" tabindex="-1"><a class="header-anchor" href="#cortex-m3微处理器"><span>Cortex-M3微处理器</span></a></h2><ul><li>由Cortex-M3内核和调试系统构成，哈佛架构，三级流水线</li><li>32位处理器，Thumb-2指令集</li></ul><p><strong>芯片级计算机=内核+外设</strong></p><p><strong>Cortex-M3内核的组成部分</strong>：</p><ul><li>Cortex-M3 core</li><li>NVIC</li><li>系统时钟</li><li>存储器保护单元</li><li>总线矩阵</li><li>调试系统</li></ul><h3 id="流水线" tabindex="-1"><a class="header-anchor" href="#流水线"><span>流水线</span></a></h3><p>主要步骤：<strong>取指、译码、执行</strong></p><p><strong>吞吐率</strong>(单位为指令/s，IPS)</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>吞吐率</mtext><mo>=</mo><mfrac><mtext>指令条数</mtext><mtext>指令流水线所需时间</mtext></mfrac></mrow><annotation encoding="application/x-tex">\\text{吞吐率} = \\frac{\\text{指令条数}}{\\text{指令流水线所需时间}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">吞吐率</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">指令流水线所需时间</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">指令条数</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>流水线执行n条指令所需时间</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>所需时间</mtext><mo>=</mo><mtext>完成一条指令所需时间</mtext><mo>+</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mtext>时间最长的指令段</mtext></mrow><annotation encoding="application/x-tex">\\text{所需时间} = \\text{完成一条指令所需时间} + (n-1)\\times \\text{时间最长的指令段} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">所需时间</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord cjk_fallback">完成一条指令所需时间</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">时间最长的指令段</span></span></span></span></span></span></p><p><strong>加速比</strong></p><p>完成一批任务不使用流水线时间和使用流水线所用时间之比</p><h3 id="总线" tabindex="-1"><a class="header-anchor" href="#总线"><span>总线</span></a></h3><p>各个部件之间传送信息的公共通路，包括：</p><ul><li>数据总线</li><li>地址总线</li><li>控制总线</li></ul><p>AMBA：<strong>高级微控制器总线架构</strong></p><p>比较有代表性的总线接口：</p><ul><li>APB：高级外设总线，支持<strong>一主多从</strong>，<strong>低成本、低功耗、结构简单</strong><ul><li>APB1：连接低速外设</li><li>APB2：连接高速外设，频率更高</li></ul></li><li>AHB：高级高性能总线，低成本，低功耗，结构简单，支持<strong>多主多从</strong></li></ul><p><strong>AHB-Lite协议</strong></p><ul><li>一主多从</li><li>I-Code指令总线和D-Code数据总线使用的协议</li></ul><p><strong>总线结构</strong></p><ul><li>I-Code指令总线：基于AHB-Lite</li><li>D-Code数据总线：基于AHB-Lite</li><li>系统总线：基于AHB-Lite</li><li>外设总线</li></ul><h3 id="存储器" tabindex="-1"><a class="header-anchor" href="#存储器"><span>存储器</span></a></h3><p>暂存指令、数据和位址</p><p>使用模型：堆栈，由一块连续内存和一栈顶指针组成</p><h3 id="存储结构" tabindex="-1"><a class="header-anchor" href="#存储结构"><span>存储结构</span></a></h3><p>Cortex-M3微处理器采用存储器与I/O设备（外设）<strong>统一编址</strong></p><p><strong>存储器映射</strong>：设置部分存储器地址范围用于外设的访问</p><h3 id="工作模态" tabindex="-1"><a class="header-anchor" href="#工作模态"><span>工作模态</span></a></h3><ul><li>两种模式：线程模式（非异常状态）、处理者模式（异常状态）</li><li>两种特权等级：用户级、特权级</li><li>三种模态</li></ul><figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="中断" tabindex="-1"><a class="header-anchor" href="#中断"><span>中断</span></a></h3><p><strong>中断响应过程</strong>：保存现场、取向量、更新寄存器</p><p><strong>中断悬起</strong></p><p>中断发生时，正在处理同级或高优先级异常，或者被掩蔽，中断不能立即得到响应</p><p><strong>中断请求信号保持</strong></p><p>中断源持续不断地产生中断请求，CPU不返回主程序，立即再次进入同一中断程序</p><p><strong>中断活跃</strong></p><p>中断服务例程开始执行，悬起位被硬件清除</p><p><strong>调试访问端口</strong>：DAP</p><p><strong>两种调试主机接口</strong></p><ul><li>JTAG</li><li>串行线（SWD）接口</li></ul><p><strong>高级跟踪接口</strong>：ATB</p><h2 id="stm32最小系统" tabindex="-1"><a class="header-anchor" href="#stm32最小系统"><span>STM32最小系统</span></a></h2><p>最小系统：用最少的元件组成微控制器可以工作的系统</p><p>STM32最小系统组成部分：微控制器、电源电路、时钟电路、复位电路、调试和下载电路</p><ul><li>复位电路：有上电复位和手动复位</li><li>时钟电路：产生脉冲信号，晶振包括有源晶振（振荡器）和无源晶振（晶体），晶振频率越大，单片机运行速度越快，功耗越大</li></ul><p>CoreSight调试架构包括<strong>调试接口协议、调试总线协议、对调试组件的控制、安全特性、跟踪接口</strong></p><h3 id="stm32开发" tabindex="-1"><a class="header-anchor" href="#stm32开发"><span>STM32开发</span></a></h3><p><strong>开发环境</strong>：</p><ul><li>嵌入式开发环境</li><li>集成开发环境</li></ul><p><strong>STM32微控制器开发模式</strong>：</p><ul><li>寄存器开发方式</li><li>标准外设库开发方式</li><li>HAL库开发方式</li></ul><p><strong>两个调试接口</strong>：</p><ul><li>JTAG</li><li>SWD</li></ul><p>Cortex-M3内核有三种启动方式，由BOOT0和BOOT1的电平组合进行选择</p><p>针对ARM内核的主流集成开发环境主要有<strong>Keil MDK和IAR EWARM</strong></p><h2 id="嵌入式c语言" tabindex="-1"><a class="header-anchor" href="#嵌入式c语言"><span>嵌入式C语言</span></a></h2><p>采用<strong>模块化、层次化</strong>的设计思想</p><p><code>const</code>：定义全局、只读、必须初始化的变量</p><p><code>static</code>：定义静态变量，只在定义该变量的源文件内有效</p><p><code>volatile</code>：不让编译器优化，从内存中读写数据，不在寄存器读写数据</p><p><code>extern</code>：声明此函数或变量定义在别的文件中</p><p><code>typedef</code>：定义别名，编译阶段生效</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> /*变量名*/ /*别名*/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>define</code>：宏定义，预处理阶段（编译之前）生效</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">#define</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> /*宏名*/ /*替换文本*/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>条件编译</strong></p><ul><li><code>#undef</code>：撤销定义的宏名</li><li><code>#ifdef</code>：判断某个宏是否未被定义</li><li><code>#elif</code>：类似<code>else if</code></li><li><code>else</code>：就是<code>else</code>的作用</li><li><code>#endif</code>：条件编译结束命令</li></ul><p><code>union</code>共用体：允许在相同的内存位置存储不同的数据类型</p><ul><li>占用的内存应足够存储共用体中内存最大的成员</li><li>使用运算符<code>.</code>访问共用体成员</li></ul><p>回调函数：系统函数调用用户定义的函数，被系统调用的函数为回调函数</p><p><code>volatile</code>三个应用场景：</p><ul><li>多任务环境下各任务间共享的标志</li><li>存储器映射的硬件寄存器</li><li>中断服务程序中修改的供其他程序检测的变量</li></ul><p><strong>指针占4个字节</strong></p><h2 id="gpio" tabindex="-1"><a class="header-anchor" href="#gpio"><span>GPIO</span></a></h2><p>通用输入输出，是微控制器（MCU）上的一种通用引脚，实现与外部设备的数字信号交互</p><p>STM32F103一共有7组GPIO，每一组的编号都为0-15，每组GPIO端口都由7个寄存器组成，负责控制该端口的16个引脚</p><p>GPIO端口由五个主要部分构成：</p><ul><li>引脚缓冲电路</li><li>方向控制</li><li>输出驱动</li><li>输入控制</li><li>复用功能切换</li></ul><h3 id="八种工作模式" tabindex="-1"><a class="header-anchor" href="#八种工作模式"><span>八种工作模式</span></a></h3><h4 id="输出模式" tabindex="-1"><a class="header-anchor" href="#输出模式"><span>输出模式</span></a></h4><p><strong>推挽输出（PP）</strong>：两个MOS管受互补信号的控制，即一个导通另一个则截止。输出高电平P-MOS导通，输出低电平N-MOS导通</p><ul><li>目的：增大输出电流，增加输出引脚的驱动能力，提高电路的负载能力和开关速度</li></ul><p><strong>开漏输出（OD）</strong>：只有下拉MOS管（N-MOS），漏极直接与I/O引脚相连，不与电源连接，<strong>处于悬空状态</strong></p><ul><li>功能：实现逻辑“与”，减少芯片内部驱动，只可<strong>输出低电平</strong>（外接上拉电阻可输出高电平）</li></ul><p><strong>复用（AF）推挽/开漏输出</strong>：一个引脚可以作为多个外设引脚使用，一个引脚某一时刻只能使用复用功能中的一个</p><h4 id="输入模式" tabindex="-1"><a class="header-anchor" href="#输入模式"><span>输入模式</span></a></h4><p><strong>上拉输入</strong>：引脚内部有上拉电阻，默认输入高电平</p><p><strong>下拉输入</strong>：引脚内部有下拉电阻，默认输入低电平</p><p><strong>浮空输入</strong>：不接上拉、下拉电阻，通过施密特触发器输入I/O引脚的信号</p><p><strong>模拟输入</strong>：施密特触发器关闭，不接上拉、下拉电阻，常用于A/D模拟</p><h2 id="中断-1" tabindex="-1"><a class="header-anchor" href="#中断-1"><span>中断</span></a></h2><p>中断和异常：<strong>本质上是改变处理器执行指令的顺序</strong></p><p>中断的处理流程：<strong>中断请求、中断响应、中断服务、中断返回</strong></p><ul><li>中断请求：<strong>会置位中断请求寄存器</strong>，向CPU发起中断</li></ul><p>中断向量表：定义在启动文件，是中断服务程序的入口地址，<strong>每个向量（函数地址）占4字节</strong></p><p>Cortex-M3集成了一个外设：<strong>NVIC（嵌套向量中断控制器）</strong>，专门用于处理中断</p><ul><li>统一管理和配置中断</li><li>通过优先级来控制中断的嵌套和深度</li></ul><p>STM32中的NVIC支持<strong>16位优先级</strong>（只有5种划分方式），因为只用到了Cortex-M3的8位优先级寄存器中的4位来配置中断优先级</p><p><strong>Reset，NMI，Hard Fault</strong>的优先级为负，且不可修改，优先级高于普通的中断</p><p>中断的使用意义：</p><ul><li>实时控制</li><li>故障处理</li><li>数据传输</li><li>不占用CPU</li></ul><h3 id="优先级" tabindex="-1"><a class="header-anchor" href="#优先级"><span>优先级</span></a></h3><p><strong>数值越小，优先级越高</strong></p><p>抢占优先级 &gt; 响应优先级 &gt; 中断向量表顺序</p><h3 id="外部中断-事件控制器-exti" tabindex="-1"><a class="header-anchor" href="#外部中断-事件控制器-exti"><span>外部中断/事件控制器 EXTI</span></a></h3><p>STM32芯片之外的外设的中断由<strong>EXTI和NVIC共同负责</strong></p><p>支持中断模式和事件模式：</p><ul><li>中断模式：软件代码编写，需要CPU</li><li>事件模式：硬件触发执行，无需CPU</li></ul><p>一共有19条外部中断线，其中0-15是对应IO引脚的外部中断</p><ul><li>对应了每一个GPIO引脚都可以<strong>配置成一个外部中断触发源</strong></li><li>GPIO中断是以组为单位的，同组GPIO端口只能共用一条中断控制线</li><li>0-4有独立的中断服务函数，5-9共用一个中断服务函数，10-15公用一个中断服务函数</li></ul><h2 id="定时器" tabindex="-1"><a class="header-anchor" href="#定时器"><span>定时器</span></a></h2><p>TIM2-7靠APB1控制，TIM1，8靠APB2控制</p><p>功能：<strong>定时、计数、输入捕获、输出比较</strong></p><p>分类：</p><ul><li>基本定时器：TIM6、7，支持16位向上计数</li><li>通用定时器：TIM2、3、4、5，支持16位向上、向下计数</li><li>高级定时器：TIM1、8，支持16位向上/向下计数</li></ul><h3 id="基本定时器" tabindex="-1"><a class="header-anchor" href="#基本定时器"><span>基本定时器</span></a></h3><p>预分频系数为1-65535，可产生中断，DAC触发信号</p><h3 id="通用定时器" tabindex="-1"><a class="header-anchor" href="#通用定时器"><span>通用定时器</span></a></h3><p><strong>核心</strong>：16位自动装载计数器</p><p><strong>组成部分</strong>：时钟源、时钟单元、捕获和比较通道</p><p><strong>预分频器（PSC）</strong></p><p>取值范围为1-65535</p><p>对时钟源进行分频，供计数器计数</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mi>C</mi><msub><mi>K</mi><mi>C</mi></msub><mi>N</mi><mi>T</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>f</mi><mrow><mi>C</mi><msub><mi>K</mi><mi>P</mi></msub><mi>S</mi><mi>C</mi></mrow></msub><mrow><mo stretchy="false">(</mo><mi>P</mi><mi>S</mi><mi>C</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">f_{CK_CNT} = \\frac{f_{CK_PSC}}{(PSC + 1)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9447em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">NT</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">PSC</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">SC</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>本质也是一个<strong>分频计数器</strong></p><p><strong>计数器（CNT）</strong></p><p>取值范围为1-65535，可实现向上、向下、向上/向下双向计数</p><p>达到预定值会产生中断/DMA请求，属于<strong>软件中断</strong></p><p><strong>自动装载寄存器（ARR）</strong></p><p>定义CNT计数器的终点，CNT达到后会进行复位</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>定时时间</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mi>R</mi><mi>R</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mfrac><mrow><mi>P</mi><mi>S</mi><mi>C</mi><mo>+</mo><mn>1</mn></mrow><msub><mi>f</mi><mrow><mi>C</mi><msub><mi>K</mi><mi>P</mi></msub><mi>S</mi><mi>C</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\\text{定时时间} = (ARR + 1) \\times \\frac{PSC + 1}{f_{CK_PSC}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">定时时间</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.00773em;">RR</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2966em;vertical-align:-0.9363em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">SC</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">PSC</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9363em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h3 id="高级定时器" tabindex="-1"><a class="header-anchor" href="#高级定时器"><span>高级定时器</span></a></h3><p>可进行互补PWM输出，进行死区控制</p><h3 id="pwm输出" tabindex="-1"><a class="header-anchor" href="#pwm输出"><span>PWM输出</span></a></h3><p>PWM：脉冲宽度调制</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>占空比</mtext><mo>=</mo><mfrac><mtext>高电平时间</mtext><mtext>周期时间</mtext></mfrac><mo>×</mo><mn>100</mn><mi mathvariant="normal">/</mi></mrow><annotation encoding="application/x-tex">\\text{占空比} = \\frac{\\text{高电平时间}}{\\text{周期时间}} \\times 100/% </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">占空比</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">周期时间</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">高电平时间</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">100/</span></span></span></span></span></p><p>通用、高级定时器可以产生PWM输出</p><ul><li>通用定时器可产生4路PWM输出</li><li>高级定时器可产生7路PWM输出</li></ul><p>注意：</p><ul><li>频率由PSC（预分频器）决定</li><li>占空比由CCR（捕获/比较寄存器）决定</li></ul><h3 id="systick定时器" tabindex="-1"><a class="header-anchor" href="#systick定时器"><span>SysTick定时器</span></a></h3><p>24位从重载值<strong>向下计数</strong>到0的计数器，是NVIC的一部分，由AHB <strong>8分频得到</strong></p><p>功能：精确延时，任务切换</p><p>一共有4个寄存器，分别是：</p><ul><li>SysTick控制及状态寄存器CTRL</li><li>SysTick重装载数值寄存器LOAD</li><li>SysTick当前数值寄存器VAL</li><li>SysTick校准数值寄存器CALIB</li></ul><h2 id="usart" tabindex="-1"><a class="header-anchor" href="#usart"><span>USART</span></a></h2><p>USART：全双工通用同步/异步串行收发器<br> UART：全双工通用异步串行收发器</p><p>通信按数据传输格式区分：</p><ul><li>并行通信：多位数据用多条数据线传输</li><li>串行通信：通过<strong>单条或者两条数据线</strong>传输数据</li></ul><p>按同步方式区分：</p><ul><li>同步通信：发送方和接受方有统一时钟线</li><li>异步通信：发送方和接受方无统一时钟线</li></ul><p>按数据传输方向区分：</p><ul><li>单工：数据只能单向传输</li><li>半双工：数据可以双向传输，但不能同时进行</li><li>全双工：数据可以同时进行双向传输</li></ul><p>波特率：每秒传输的二进制位数，单位为bit/s,bps</p><p>字符速率：每秒传输的字符数</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>波特率</mtext><mo>=</mo><mtext>字符速率</mtext><mo>×</mo><mtext>字符位数</mtext></mrow><annotation encoding="application/x-tex">\\text{波特率} = \\text{字符速率} \\times \\text{字符位数} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">波特率</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord cjk_fallback">字符速率</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">字符位数</span></span></span></span></span></span></p><h3 id="uart模块" tabindex="-1"><a class="header-anchor" href="#uart模块"><span>UART模块</span></a></h3><p>点对点通信</p><p>由TxD，RxD，GND三条线组成</p><ul><li>TxD：发送</li><li>RxD：接收</li><li>GND：信号地线</li></ul><p>通讯协议：可分为<strong>通信传输速率和数据帧格式</strong></p><p><strong>异步串行通信协议</strong></p><p>异步串行通信数据帧：</p><ul><li>起始位：0表示传输数据的开始</li><li>数据位</li><li>校验位：用于检测数据是否有效</li><li>停止位：可以是1，1.5，2位</li><li>空闲位：1表示空闲</li></ul><p>检验模式：</p><ul><li>无检验：数据位直接跟停止位</li><li>偶检验：让数据位和校验位的1的出现次数为偶数，校验位根据数据位中1出现次数是奇是偶来填1还是0</li><li>奇检验：让数据位和校验位的1的出现次数为奇数</li></ul><p>RS-232是<strong>串行通信物理接口标准</strong>，为<strong>异步串行通信接口</strong>，电气标准为负逻辑，需要进行<strong>电平转换</strong>后和微控制器相连，微控制器标准为<strong>TTL电平标准</strong></p><h3 id="usart模块" tabindex="-1"><a class="header-anchor" href="#usart模块"><span>USART模块</span></a></h3><p>组成部分：</p><ul><li>数据收发寄存单元</li><li>波特率发生器</li><li>发送器/接收器控制单元</li></ul><p>在UART基础上支持同步</p><p>编程模式：</p><ul><li>轮询</li><li>中断</li><li>DMA（直接内存访问）</li></ul><h2 id="dma" tabindex="-1"><a class="header-anchor" href="#dma"><span>DMA</span></a></h2><p>嵌入式数据处理过程：<br><img src="'+x+'" alt="" loading="lazy"></p><p>直接内存访问，允许外部设备和存储器进行直接的数据交换，无需CPU的介入，<strong>每次只传输一个字节，一个DMA同一时刻只有1个请求有效</strong></p><p>工作流程：<strong>DMA请求、DMA响应、DMA传输、DMA结束</strong></p><p>运行机制：通过专用DMA控制器（DMAC）接管总线控制权，实现外设与存储器、存储器不同区域之间的高速数据搬运</p><p>优势：</p><ul><li>解放CPU</li><li>提高传输效率</li><li>降低系统功耗</li></ul><p>应用场景：</p><ul><li>存储设备I/O</li><li>高速通信通道</li><li>数据采集系统</li><li>图像处理</li><li>多处理机系统</li></ul><p><strong>DMAC的组成部分</strong></p><ul><li>地址寄存器</li><li>状态寄存器</li><li>控制寄存器</li><li>字节计数器</li></ul><p>STM32F103包含2个DMA控制器：DMA1，DMA2</p><ul><li>DMA1有7个传输通道 <ul><li>包括外设：TIMx（x=1,2,3,4）、ADC1、SPI1、IICx（x=1,2）、USARTx（x=1,2,3）</li></ul></li><li>DMA2有5个传输通道 <ul><li>包括外设：（TIMx（x=5,6,7,8）、ADC3、SPI/I2S3、USART4、DAC通道1、2和SDIO</li></ul></li></ul><p>DMA控制器提供2个AHB主端口</p><ul><li>AHB存储器端口</li><li>AHB外设端口</li></ul><p>DMA关键配置参数：</p><ul><li>传输方向</li><li>数据密度</li><li>地址递增</li><li>传输模式</li><li>中断能力</li></ul><p>DMA传输模式：</p><ul><li>单次模式</li><li>循环模式</li></ul><p>DMA使用仲裁器对多个DMA请求进行优先级管理</p><ul><li>分为4个优先级：最高优先级、高优先级、中等优先级、低优先级</li><li>如果2个请求有相同的软件优先级，则较低编号的通道比较高编号的通道有较高的优先权</li></ul><p>DMA中断事件，分别对应三个中断标志：HTIF、TCIF、TEIF</p><ul><li>HT：传输一半</li><li>TC：传输完成</li><li>TE：传输错误</li></ul><h2 id="spi" tabindex="-1"><a class="header-anchor" href="#spi"><span>SPI</span></a></h2><p>串行外围设备接口</p><ul><li>全双工</li><li>串行</li><li>同步</li><li>主从架构（一主多从）</li><li>使用单主设备通信协议</li><li>主设备：提供时钟</li><li>从设备：接收时钟</li></ul><p>SPI接口使用四条信号线通信：</p><ul><li>MISO：串行输入数据线，主设备输入/从设备输出引脚</li><li>MOSI：串行输出数据线，主设备输出/从设备输入引脚</li><li>CS/SS：设备选择线，从设备片选信号，由主设备控制，有多个从机的话则不止一条，<strong>低电平有效</strong></li><li>SCLK：串行时钟信号，由主设备产生</li></ul><h3 id="工作原理" tabindex="-1"><a class="header-anchor" href="#工作原理"><span>工作原理</span></a></h3><p>主机和从机都有一个<strong>串行移位寄存器</strong></p><ul><li>发送数据的时候，主机移位寄存器的最高位被推到MOSI，从机通过MOSI接收数据并放到自己移位寄存器的最低位</li><li>接收数据的时候，从机移位寄存器的最高位被推到MISO，主机通过MISO接收数据并放到自己移位寄存器的最低位</li><li>一个字节发送完后，主机和从机的移位寄存器的内容被交换</li></ul><figure><img src="'+y+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="数据传输的时序模式" tabindex="-1"><a class="header-anchor" href="#数据传输的时序模式"><span>数据传输的时序模式</span></a></h3><p>主从设备要调整成<strong>相同的时序模式！！！</strong></p><p><strong>CPOL（时钟极性）</strong>：用来配置SCLK的空闲电平状态</p><ul><li>0为低电平</li><li>1为高电平</li></ul><p><strong>CPHA（时钟相位）</strong>：定义数据的采集时间</p><ul><li>0代表在时钟的第一个跳变沿（上升或下降）采样数据，在第二个跳变沿发送数据</li><li>1代表在时钟的第二个跳变沿（上升或下降）采样数据，在第一个跳变沿发送数据</li><li>第一个跳变沿是从空闲到非空闲的边沿</li><li>第二个跳变沿是从非空闲到空闲的边沿</li></ul><p>一共有4种标准的SPI模式，由CPOL和CPHA的两个位的0/1组成</p><h2 id="i2c" tabindex="-1"><a class="header-anchor" href="#i2c"><span>I2C</span></a></h2><p>串行、半双工、同步总线，是一种<strong>多主机总线</strong>，具备<strong>冲突检测和仲裁</strong>，抗干扰能力强</p><p>I2C总线由两根双向的信号线组成：</p><ul><li>SDA：用于收发数据</li><li>SCL：用于通信双方时钟同步</li></ul><p>每个连接到I2C总线上的器件都有一个唯一的地址（7bit），且每个器件都可以作为主机也可以作为从机（<strong>但同一时刻只能有一个主机</strong>）</p><h3 id="具体阐述" tabindex="-1"><a class="header-anchor" href="#具体阐述"><span>具体阐述</span></a></h3><p>通信步骤：</p><ol><li>主机发送起始信号启用总线</li><li>主机发送一个字节数据指明从机地址和后续字节的传送方向</li><li>被寻址的从机发送应答信号回应主机</li><li>发送器发送一个字节数据</li><li>接收器发送应答信号回应发送器</li><li>........ （循环步骤4、5）</li><li>通信完成后主机发送停止信号释放总线</li></ol><p><strong>起始信号</strong>：SCL为高电平时，SDA由高变低</p><p><strong>停止信号</strong>：SCL为高电平时，SDA由低变高</p><p>起始信号和停止信号都是由主机发出，从机只能被动应答</p><p><strong>空闲时，SCL和SDA都是高电平</strong></p><p>传输数据的最小单位是1个字节，主机发送起始信号后要发送1个字节的数据，该数据的高7位表示从机地址，最低位表示后续字节的传送方向</p><ul><li>0：主机发送数据给从机</li><li>1：从机发送数据给主机</li></ul><p>两种停止情况：</p><ul><li>主机不想通信，发送停止信号</li><li>从机不想通信，不进行应答</li></ul><p>I2C通信时一个数据帧一共有9位</p><ul><li>发送时先发高位再发低位，每次发1个字节数据</li><li>发送方发送完数据后接收方要传回1位应答位回应发送方</li></ul><p><strong>应答位</strong>：0<br><strong>非应答位</strong>：1</p><p><strong>同步数据信号</strong></p><ul><li>SCL为高电平时，数据线SDA要保持稳定，不允许发生变化，接收方从数据线上读取1位数据</li><li>SCL为低电平时，数据线SDA可以发生变化，此时发送方向数据线发送1位数据</li></ul><p><strong>时钟同步</strong></p><p>是通过I2C总线上SCL的线与功能实现的</p><ul><li>如果有多个主机同时产生时钟，那么只有所有主机都发送高电平时，SCL上才表现为高电平</li><li>否则SCL都表现为低电平</li></ul><p><strong>仲裁</strong></p><ul><li>总线仲裁：当所有主机在SDA上都写1时，SDA的数据才是1，否则是0</li><li>主机每发送1bit数据，<strong>在SCL为高电平时</strong>，就检查SDA的电平和自己发送的数据是否一致，若不一致说明自己输掉了仲裁，然后<strong>停止向SDA写数据</strong></li></ul><p><strong>典型时序</strong></p><figure><img src="'+b+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="adc" tabindex="-1"><a class="header-anchor" href="#adc"><span>ADC</span></a></h2><p>模数转换器，将模拟信号转换为数字信号</p><p>主要过程包括：<strong>采样、保持、量化、编码</strong></p><p><strong>参考电压</strong>：进行模拟到数字转换时，ADC所能测量的最大模拟输入电压</p><p><strong>香农采样定理</strong></p><p>采样频率应该不小于模拟信号频谱中<strong>最高频率的2倍</strong></p><p>常用的四种ADC输入模式</p><ul><li>单端输入</li><li>差分输入</li><li>伪差分输入</li><li>全差分输入</li></ul><p><strong>常用的4种ADC</strong></p><figure><img src="'+A+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mo>−</mo><mo>∑</mo></mrow><annotation encoding="application/x-tex">\\Delta - \\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">Δ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span></span></span></span>使用了<strong>过采样和噪声整形</strong>技术</li></ul><h3 id="主要技术参数" tabindex="-1"><a class="header-anchor" href="#主要技术参数"><span>主要技术参数</span></a></h3><p><strong>分辨率</strong></p><p>A/D转换器对输入模拟量微小变化的分辨能力，通常用二进制数的有效位表示</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>分辨率</mtext><mo>=</mo><mfrac><mtext>参考电压</mtext><msup><mn>2</mn><mtext>有效位</mtext></msup></mfrac></mrow><annotation encoding="application/x-tex">\\text{分辨率} = \\frac{\\text{参考电压}}{2^{\\text{有效位}}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">分辨率</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">有效位</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">参考电压</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>量化误差</strong></p><p>有限分辨率而引起的误差，反映A/D转换器实际输出数字量和理想输出之间的差异</p><p>通常为1个或半个最小数字量的模拟变化量，表示为1LSB、 1/2LSB</p><p><strong>转换时间</strong></p><p>指从转换控制信号到ADC输出端得到稳定的数字量所需要的时间</p><p>转换时间=采样保持时间+量化编码时间 = 1 / 转换速率</p><p><strong>采样频率</strong>应小于等于ADC芯片的最高转换速率</p><h3 id="stm32的adc" tabindex="-1"><a class="header-anchor" href="#stm32的adc"><span>STM32的ADC</span></a></h3><p>ADC由五部分组成：</p><ul><li>ADC引脚</li><li>模拟多路开关</li><li>ADC时钟</li><li>注入或规则通道</li><li>中断</li></ul><p>集成有三个12位<strong>逐次逼近型</strong>的A/D转换器，ADC1和ADC3能产生DMA请求</p><p>转换结果是12位二进制数，可以<strong>左对齐/右对齐</strong>存储在16位的数据寄存器中</p><p>有18个通道，可以实现16个外部模拟输入通道和2个内部信号源的AD转换</p><p>各个通道的AD转换可以采用<strong>单次、连续、扫描、间断</strong>模式执行</p><ul><li>单次：ADC只执行一次转换</li><li>连续：当前ADC转换结束立刻启动下一个转换</li><li>扫描：扫描一组模拟通道 <ul><li>单次：扫描完本组后停止</li><li>连续：扫描完本组后从第一个通道继续扫描</li></ul></li><li>间断：用于多个通道的规则组和注入组</li></ul><p><strong>流程</strong></p><ul><li>信号输入</li><li>触发信号 <ul><li>软件触发或EXTI外部触发或定时器触发</li><li>硬件触发源分为规则通道和注入通道</li></ul></li><li>AD转换</li><li>数据保存</li></ul><p>两种组转换模式：<strong>规则组和注入组</strong></p><ul><li>规则组：允许16个规则通道进行转换 <ul><li>EOC标志置位，产生中断或DMA</li></ul></li><li>注入组：允许4个通道进行转换，4个注入通道寄存器存放转换结果 <ul><li>无DMA，JEOC置位，产生相应中断</li></ul></li></ul><p>ADC触发信号产生方式：</p><ul><li>软件触发</li><li>外部触发 <ul><li>触发源：中断线、定时器</li></ul></li></ul><p>三种中断事件：</p><ul><li>EOC中断</li><li>JEOC中断</li><li>AWD中断</li></ul><p>ADC总的转换时间 = 采样时间 + 12.5个周期，单位是周期</p><p>数据对齐：</p><ul><li>左对齐：数据传输从高位开始</li><li>右对齐：数据传输从低位开始</li></ul><p><strong>校准的目的</strong>：减少因内部电容变化导致的误差</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2>',312)),o(i,{data:[{id:"概论"},{id:"Cortex-M3微处理器"},{id:"STM32最小系统"},{id:"嵌入式c语言"},{id:"GPIO"},{id:"中断"},{id:"定时器"},{id:"USART"},{id:"DMA"},{id:"SPI"},{id:"I2C"},{id:"ADC"}],active:0},{title0:l(({value:n,isActive:p})=>[...a[0]||(a[0]=[t("概论",-1)])]),title1:l(({value:n,isActive:p})=>[...a[1]||(a[1]=[t("Cortex-M3微处理器",-1)])]),title2:l(({value:n,isActive:p})=>[...a[2]||(a[2]=[t("STM32最小系统",-1)])]),title3:l(({value:n,isActive:p})=>[...a[3]||(a[3]=[t("嵌入式c语言",-1)])]),title4:l(({value:n,isActive:p})=>[...a[4]||(a[4]=[t("GPIO",-1)])]),title5:l(({value:n,isActive:p})=>[...a[5]||(a[5]=[t("中断",-1)])]),title6:l(({value:n,isActive:p})=>[...a[6]||(a[6]=[t("定时器",-1)])]),title7:l(({value:n,isActive:p})=>[...a[7]||(a[7]=[t("USART",-1)])]),title8:l(({value:n,isActive:p})=>[...a[8]||(a[8]=[t("DMA",-1)])]),title9:l(({value:n,isActive:p})=>[...a[9]||(a[9]=[t("SPI",-1)])]),title10:l(({value:n,isActive:p})=>[...a[10]||(a[10]=[t("I2C",-1)])]),title11:l(({value:n,isActive:p})=>[...a[11]||(a[11]=[t("ADC",-1)])]),tab0:l(({value:n,isActive:p})=>[...a[12]||(a[12]=[s("p",null,"嵌入式系统是什么 发展方向是什么 得益于什么的发展 以什么为中心 有什么特性",-1),s("p",null,"嵌入式系统的设计目标",-1),s("p",null,"计算的概念",-1),s("p",null,"MCU FPGA SoC的定义",-1),s("p",null,"ARM应用的两种开发方式",-1),s("p",null,"冯诺依曼架构的组成部分 系统的瓶颈是什么 为什么 后续如何改进的 内外存储器存放什么",-1),s("p",null,"哈佛架构对什么进行区分 设置了什么进行存取",-1),s("p",null,"ISA是什么 有什么用 有哪两种指令集",-1),s("p",null,"计算机体系架构是什么",-1),s("p",null,"ARM的体系架构 对于开发人员来说体系架构的重要部分是什么",-1)])]),tab1:l(({value:n,isActive:p})=>[...a[13]||(a[13]=[s("p",null,"Cortex-M3微处理器由什么构成 是什么架构 什么流水线 多少位处理器 什么指令集",-1),s("p",null,"芯片级计算机由什么组成",-1),s("p",null,"Cortex-M3内核的组成部分",-1),s("p",null,"流水线的主要步骤",-1),s("p",null,"吞吐率怎么算",-1),s("p",null,"指令流水线执行时间怎么算",-1),s("p",null,"加速比怎么算",-1),s("p",null,"AMBA是什么 总线是什么 包括哪些总线",-1),s("p",null,"有代表性的总线接口和他们的特性 APB特点",-1),s("p",null,"Cortex-M3总线结构",-1),s("p",null,"APB1和APB2的区别",-1),s("p",null,"AHB-Lite协议的特点 什么总线使用了这个协议",-1),s("p",null,"存储器的作用 它的模型 它的组成部分",-1),s("p",null,"存储结构是什么 存储器映射是什么",-1),s("p",null,"有几种模式 分别是什么 几种特权等级 分别是什么 几种模态 分别是什么",-1),s("p",null,"中断的响应过程",-1),s("p",null,"中断悬起是什么 中断活跃是什么 中断请求信号保持是什么",-1),s("p",null,"DAP是什么 有哪两种调试主机端口",-1),s("p",null,"CoreSight调试架构包括什么",-1),s("p",null,"ATB是什么",-1)])]),tab2:l(({value:n,isActive:p})=>[...a[14]||(a[14]=[s("p",null,"最小系统是什么",-1),s("p",null,"STM32最小系统的组成部分 复位有几种类型 晶振包括什么 晶振频率和单片机的关系",-1),s("p",null,"STM32有什么开发环境",-1),s("p",null,"STM32微控制器有什么开发模式",-1),s("p",null,"两个调试接口",-1),s("p",null,"Cortex-M3内核有几种启动方式 由谁决定",-1),s("p",null,"针对ARM内核的主流集成开发环境有哪些",-1),s("p",null,null,-1)])]),tab3:l(({value:n,isActive:p})=>[...a[15]||(a[15]=[s("p",null,"嵌入式开发采用什么设计思想",-1),s("p",null,"const static volatile extern typedef define有什么作用",-1),s("p",null,"define和typedef的区别",-1),s("p",null,"什么是回调函数",-1),s("p",null,"共用体是什么 如何访问共用体成员",-1),s("p",null,"volatile的三个应用场景",-1),s("p",null,"指针占几个字节",-1)])]),tab4:l(({value:n,isActive:p})=>[...a[16]||(a[16]=[s("p",null,"GPIO的全称是什么",-1),s("p",null,"STM32F103有几组GPIO，每一组的编号是多少到多少，每组GPIO端口由几个寄存器组成",-1),s("p",null,"GPIO端口由哪五个主要部分构成",-1),s("p",null,"GPIO由几种输入输出模式",-1),s("p",null,"推挽输出的特性，输出高电平谁导通，输出低电平呢，目的是什么",-1),s("p",null,"开漏输出的特性，功能是什么",-1),s("p",null,"复用输出的定义",-1),s("p",null,"上拉输入默认输入什么电平，下拉输入呢",-1),s("p",null,"浮空输入接电阻吗，会通过什么器件",-1),s("p",null,"模拟输入常用于什么情况，有通过什么器件吗",-1),s("p",null,null,-1)])]),tab5:l(({value:n,isActive:p})=>[...a[17]||(a[17]=[s("p",null,"中断和异常的本质",-1),s("p",null,"中断的处理过程",-1),s("p",null,"中断请求如何执行",-1),s("p",null,"中断向量表是什么 每个向量占几个字节",-1),s("p",null,"NVIC的名称是什么 作用",-1),s("p",null,"有哪些中断的优先级为负",-1),s("p",null,"STM32中的NVIC支持几位优先级，为什么",-1),s("p",null,"中断的使用意义",-1),s("p",null,"如何比较优先级",-1),s("p",null,"优先级的类型和他们的优先顺序",-1),s("p",null,"EXTI的名称是什么",-1),s("p",null,"外设的中断由谁共同负责",-1),s("p",null,"EXIT支持哪两种模式 具体有什么区别",-1),s("p",null,"EXTI有几条外部中断线 IO引脚的外部中断线有几条，编号是多少",-1),s("p",null,"GPIO中断是以什么为单位的",-1),s("p",null,"EXTI中断服务函数是怎么分配给IO引脚的",-1),s("p",null,null,-1)])]),tab6:l(({value:n,isActive:p})=>[...a[18]||(a[18]=[s("p",null,"定时器的基本功能（四个）",-1),s("p",null,"基本定时器、通用定时器、高级定时器是TIM几，他们支持几位，如何计数",-1),s("p",null,"通用定时器的核心 通用定时器的组成部分",-1),s("p",null,"使用通用定时器计数的周期的公式",-1),s("p",null,"通用定时器实现计数功能的三个组件是什么 说出名字和缩写",-1),s("p",null,"计数器计数达到预定值会发生什么 产生的中断属于什么中断",-1),s("p",null,"高级定时器的功能",-1),s("p",null,"谁接在APB1 谁接在APB2",-1),s("p",null,"通用定时器和高级定时器可以有几路的PWM输出",-1),s("p",null,"什么是占空比",-1),s("p",null,"在PWM中，谁控制频率，谁控制占空比",-1),s("p",null,"CCR的中文名称是什么",-1),s("p",null,"SysTick定时器是几位的 向上还是向下计数 功能是什么 怎么得到的 四个寄存器分别是什么",-1)])]),tab7:l(({value:n,isActive:p})=>[...a[19]||(a[19]=[s("p",null,"USART和UART的定义",-1),s("p",null,"可以有哪三种方式划分通信方式，他们分别可以分成什么类，每个类的定义",-1),s("p",null,"波特率是什么，单位是什么 字符速率是什么 波特率和字符速率的转换公式",-1),s("p",null,"通讯协议由什么组成",-1),s("p",null,"异步串行通信数据帧的组成部分",-1),s("p",null,"数据检验模式的分类和他们的定义",-1),s("p",null,"UART由哪三根线组成，它们定义分别是什么",-1),s("p",null,"USART模块的三个组成部分",-1),s("p",null,"波特率时钟频率和波特率的转换公式",-1),s("p",null,"USART的编程模式有哪三种",-1),s("p",null,"RS-232是什么，电气标准是什么，微控制器的标准是什么，它们俩之间是否要进行电平转换",-1)])]),tab8:l(({value:n,isActive:p})=>[...a[20]||(a[20]=[s("p",null,"DMA的名称 DMAC的名称，作用",-1),s("p",null,"DMA的工作流程 优势 应用场景 运行机制",-1),s("p",null,"DMAC的组成部分",-1),s("p",null,"STM32F103包含几个DMA控制器 各自有几个通道",-1),s("p",null,"DMAC提供几个AHB主端口 分别是什么",-1),s("p",null,"DMA的关键配置参数",-1),s("p",null,"DMA的传输模式",-1),s("p",null,"DMA使用什么进行优先级管理 有几个优先级 优先级相同时怎么办",-1),s("p",null,"DMA有几个中断事件 分别是什么意思 对应什么中断标志",-1),s("p",null,null,-1)])]),tab9:l(({value:n,isActive:p})=>[...a[21]||(a[21]=[s("p",null,"SPI的名称 特性 使用了什么协议",-1),s("p",null,"SPI使用几条信号线通信 分别是什么 有什么功能",-1),s("p",null,"SPI的工作原理是什么",-1),s("p",null,"有几种标准的SPI模式",-1),s("p",null,"主从设备的时序模式要相同吗",-1),s("p",null,"用什么来配置SCLK的空闲电平状态 具体是什么",-1),s("p",null,"用什么来定义数据的采集时间，具体是什么",-1),s("p",null,null,-1)])]),tab10:l(({value:n,isActive:p})=>[...a[22]||(a[22]=[s("p",null,"I2C的特性 具备什么功能 是什么总线",-1),s("p",null,"I2C总线由什么组成 有几条信号线 分别是什么 有什么用",-1),s("p",null,"同一时刻只能有一个主机吗",-1),s("p",null,"从机的地址是几位的",-1),s("p",null,"通信步骤是什么",-1),s("p",null,"起始信号和停止信号是什么",-1),s("p",null,"空闲的时候SCL和SDA是什么电平",-1),s("p",null,"传输数据的最小的单位是什么 主机发送起始信号后发送的1个字节的数据的组成部分 最低位具体代表什么意思",-1),s("p",null,"有哪两种通信的停止情况",-1),s("p",null,"I2C通信时一个数据帧的组成情况",-1),s("p",null,"应答位和非应答位用什么电平表示",-1),s("p",null,"同步数据信号的做法",-1),s("p",null,"时钟同步是什么",-1),s("p",null,"仲裁是什么",-1)])]),tab11:l(({value:n,isActive:p})=>[...a[23]||(a[23]=[s("p",null,"ADC是什么 主要过程有什么 参考电压是什么",-1),s("p",null,"香农采样定理是什么",-1),s("p",null,[t("常用的4种"),s("strong",null,"ADC输入模式")],-1),s("p",null,[t("有哪四种常用的ADC "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"Δ"),s("mo",null,"−"),s("mo",null,"∑")]),s("annotation",{encoding:"application/x-tex"},"\\Delta - \\sum")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7667em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"Δ"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mop op-symbol small-op",style:{position:"relative",top:"0em"}},"∑")])])]),t("用了什么技术")],-1),s("p",null,"分辨率的计算公式 量化误差的最小单位",-1),s("p",null,"转换时间的计算公式 转换速率怎么算 采样频率和ADC芯片的最高转换速率的关系",-1),s("p",null,"ADC由哪五部分组成 STM32集成了几个什么类型的AD转换器 转换结果是几位二进制数 可以存在什么样的数据寄存器中",-1),s("p",null,"AD转换有什么模式 分别有什么功能",-1),s("p",null,"ADC的流程是什么",-1),s("p",null,"ADC有几种组转换模式 分别是什么 分别会产生什么样的中断",-1),s("p",null,"ADC触发信号产生的方式",-1),s("p",null,"ADC有几种中断事件 分别是什么",-1),s("p",null,"ADC总的转换时间怎么算",-1),s("p",null,"ADC有什么数据对齐的方式 分别对应什么",-1),s("p",null,"ADC校准的目的是什么",-1)])]),_:1})])}const D=e(v,[["render",C]]),S=JSON.parse('{"path":"/resource/coursenote/junior/embedding_system.html","title":"嵌入式系统原理及实验","lang":"zh-CN","frontmatter":{"title":"嵌入式系统原理及实验","index":false,"article":false,"timeline":false,"description":"本页PDF 嵌入式系统概论 嵌入式系统 嵌入式系统是一切非PC和大型机的计算机系统 嵌入式系统以高性能、智能化发展方向为主，且得益于微电子技术、通信技术、感知测量技术的发展 以应用为中心 具有实时性、可靠性、功耗约束 设计目标：从高性能转向用户需求和资源约束的平衡 MCU：微控制器单元，也叫做单片机，将内存、计数器等集成在一块芯片上，芯片级计算机 FP...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"WebPage\\",\\"name\\":\\"嵌入式系统原理及实验\\",\\"description\\":\\"本页PDF 嵌入式系统概论 嵌入式系统 嵌入式系统是一切非PC和大型机的计算机系统 嵌入式系统以高性能、智能化发展方向为主，且得益于微电子技术、通信技术、感知测量技术的发展 以应用为中心 具有实时性、可靠性、功耗约束 设计目标：从高性能转向用户需求和资源约束的平衡 MCU：微控制器单元，也叫做单片机，将内存、计数器等集成在一块芯片上，芯片级计算机 FP...\\"}"],["meta",{"property":"og:url","content":"https://xbzhong.cn/xbZhong/resource/coursenote/junior/embedding_system.html"}],["meta",{"property":"og:site_name","content":"阿b的博客"}],["meta",{"property":"og:title","content":"嵌入式系统原理及实验"}],["meta",{"property":"og:description","content":"本页PDF 嵌入式系统概论 嵌入式系统 嵌入式系统是一切非PC和大型机的计算机系统 嵌入式系统以高性能、智能化发展方向为主，且得益于微电子技术、通信技术、感知测量技术的发展 以应用为中心 具有实时性、可靠性、功耗约束 设计目标：从高性能转向用户需求和资源约束的平衡 MCU：微控制器单元，也叫做单片机，将内存、计数器等集成在一块芯片上，芯片级计算机 FP..."}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:image","content":"https://xbzhong.cn/xbZhong/myMajor/note/image-20251227145217619.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-01-23T15:58:13.000Z"}],["meta",{"property":"article:modified_time","content":"2026-01-23T15:58:13.000Z"}]]},"git":{"createdTime":1769183893000,"updatedTime":1769183893000,"contributors":[{"name":"XIANBO ZHONG","username":"","email":"2396768163@qq.com","commits":1}]},"readingTime":{"minutes":27.4,"words":8219},"filePathRelative":"resource/coursenote/junior/embedding_system.md","excerpt":"<p><a href=\\"/pdfs/resource/coursenote/junior/embedding_system.pdf\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">本页PDF</a></p>\\n<h2>嵌入式系统概论</h2>\\n<p><strong>嵌入式系统</strong></p>\\n<ul>\\n<li>嵌入式系统是一切非PC和大型机的计算机系统</li>\\n<li>嵌入式系统以<strong>高性能、智能化</strong>发展方向为主，且得益于<strong>微电子技术、通信技术、感知测量技术</strong>的发展</li>\\n<li>以<strong>应用</strong>为中心</li>\\n<li>具有<strong>实时性、可靠性、功耗约束</strong></li>\\n</ul>","autoDesc":true}');export{D as comp,S as data};
